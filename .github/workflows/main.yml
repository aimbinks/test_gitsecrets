name: Secret Scan

on:
  push:
    branches:
      - main

jobs:
  scan-secrets:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3  # Action officielle pour cloner le code
    
    - name: Install git-secrets
      run: |
        sudo apt-get update
        sudo apt-get install -y git-secrets

    - name: Run git-secrets scan
      run: |
        git secrets --install
        git secrets --register-aws
        git secrets --scan
